# Микросервис Регистрации и Авторизации Пользователей

Этот микросервис предоставляет функционал для регистрации и авторизации пользователей, построенный на фреймворке FastAPI.

## Функциональные возможности

- **Регистрация пользователей**: Пользователи могут зарегистрироваться, предоставив необходимые данные.
- **Авторизация пользователей**: Пользователи могут войти в систему, используя зарегистрированные учетные данные.
- **Восстановление пароля**: Пользователи могут восстановить(обновить) пароль от своей учётной записи, если это необходимо.
- **Подтверждение почтой**: Все действия: регистрация, авторизация, восстановление пароля, пользователь будет должен подтверждать одноразовым 4х значным кодом, который будет отправляться на его почту.
- **Контроль безопасности**: Каждое последующее действие, не может быть выполнено, пока не выполнено предыдущее, это достигнуто, путём ввода и проверок, уникальных ключей сессии.
- **JWT-аутентификация**: Для безопасной аутентификации используются JSON Web Tokens (JWT).
- **Шифрование паролей**: Пароли надежно шифруются с использованием PBKDF2.
- **Ролевая модель доступа**: Различные роли и разрешения для пользователей.


## Содержание

- [Микросервис Регистрации и Авторизации Пользователей](#микросервис-регистрации-и-авторизации-пользователей)
  - [Функциональные возможности](#функциональные-возможности)
  - [Содержание](#содержание)
    - [Краткое описание структуры](#краткое-описание-структуры)
  - [Начало работы](#начало-работы)
    - [Установка](#установка)
    - [Запуск сервиса](#запуск-сервиса)
  - [API Документация](#api-документация)
  - [Контакты](#контакты)

___

### Краткое описание структуры

**Каталоги:**
* **alembic**: Модуль для работы с миграциями баз данных.
* **api**: API проекта с маршрутами.
* **backend**: Логика проекта.
* **database**: Работа с базами данных через SQLAlchemy.
* **jwt_tools**: Модуль для работы с JWT токеном: создание токена, декодирование, декорирование маршрутов.
* **models**: Pydantic модели проекта, для валидации данных.
* **redis_tools**: Подключение и работа с хранилищем Redis.
* **template_message**: Шаблоны сообщений для писем на почту.

**Файлы:**
* **alembic.ini**: Конфигурационный файл с настройками миграций на Alembic.
* **config.py**: Конфигурационный файл проекта, для получения переменных из окружения.
* **docker-compose.yaml**: Конфигурация docker-compose(запуск нескольких приложений в разных контейнерах вместе).
* **Dockerfile**: Конфигурация докера(инструкция для запуска контейнера с основным приложением).
* **main.py**: Исполнительный файл проекта.
* **nginx.config**: Конфигурационный файл с настройками сервера Nginx.
* **README.md**: Файл описание проекта.
* **requirements.txt**: Файл с описанием зависимостей используемых в проекте.

___

## Начало работы

Эти инструкции помогут вам запустить копию проекта на локальном компьютере для целей разработки и тестирования.


### Установка

1. Клонируйте репозиторий
    ```sh
    git clone https://github.com/TURRA7/REGISTRATION_AUTHORIZATION.git
    ```
2. Перейдите в директорию проекта
    ```sh
    cd REGISTRATION_AUTHORIZATION
    ```
3. В файлах **docker-compose.yaml** и **nginx.conf** следует указать ваши данные, согласно комментариям(для указания доменного имени, его следует зарегистрировать в панели управления вашего хоста "привязать ip к доменному имени").
4. Если вы собираетесь использовать **https** соединение, вам следует установить **certbot**, для получения **SSL сертификата**(если вам достаточно http соединения, просто удалите: 30, 31, 32, 34, 35 ,36 строки), вот как получить SSL сертификат:
    1. Заходим на сайт
         ```
         https://certbot.eff.org/instructions
         ```
    2. Выбираем свой сервер в Software и свою OS в System
    3. Далее следуем инструкции...
    4. После чего, нам следует найти файлы **Linux**:
        ```
        sudo find /etc -name "*.crt"
        sudo find /etc -name "*.key"
        ```
      Запоминаем их расположение и указываем его в файле **nginx.conf** в строках **31** и **32**. Так же указываем их в фалйе **docker-compose.yaml** в строках **71** и **72**. SSL сертификат добавлен!

### Запуск сервиса

1. Перейдя через терминал в директорию проекта, активируем команду:
    ```
    docker-compose biuld | или | sudo docker-compose biuld
    ```
    **Ожидаем сборку контейнера...**

2. После сборки, для запуска контейнера, следует активировать команду:
    ```
    docker-compose up | или | sudo docker-compose up
    ```
   **После непродолжительного запуска, сервис активен!**

3. Для остановки работы контейнера вы можете воспользоваться из того же терминала комбинацией **Ctrl + C**
4. Для разборки контейнера до образа, воспользуйтесь командой:
    ```
    docker-compose down | или | sudo docker-compose down
    ```
    **После чего вы можете вносить изменения в проект и пересобирать его с помощью команды из первого пункта.**



Сервер будет запущен на `http://localhost:8000`. Указав вместо "localhost" - ip или ваше доменное имя, сервер будет запущен на нём!

## API Документация

Подробное описание API доступно по адресу `http://localhost:8000/docs`

___

## Контакты

Моя почта: **turra777@mail.ru**

Мой телеграм: **https://t.me/chicano_712**

